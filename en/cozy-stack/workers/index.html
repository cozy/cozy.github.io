<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <meta name="author" content="CozyCloud - https://cozy.io">
        <link rel="canonical" href="https://docs.cozy.io/cozy-stack/workers/">
        <link rel="shortcut icon" href="../../img/favicon.png">
        
        <title>Workers - Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
            <link href="../../css/extra.css" rel="stylesheet">
            <link href="../../css/highlight_theme.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://docs.cozy.io/">Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Install <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../install/">Install Cozy on your own server</a>
</li>
                            
<li >
    <a href="../../install/debian/">Debian</a>
</li>
                            
<li >
    <a href="../../install/manual/">Manual installation</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Develop <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="/en/dev/">Let's hack some code</a>
</li>
                            
<li >
    <a href="/en/dev/connect-mobile-app-local-stack/">Connect a mobile app to your local stack</a>
</li>
                            
<li >
    <a href="/en/dev/intro/">Architecture</a>
</li>
                            
<li >
    <a href="/en/dev/app/">Create your first app</a>
</li>
                            
<li >
    <a href="/en/dev/konnector/">Develop a connector</a>
</li>
                            
<li >
    <a href="/en/dev/cordova/">Create a mobile app with cordova</a>
</li>
                            
<li >
    <a href="/en/dev/git-flow/">Git Flow</a>
</li>
                            
<li >
    <a href="/en/dev/sendmail/">How to send mail in development</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">References</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">cozy-client-js</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-client-js/README/">README</a>
</li>
            
<li >
    <a href="../../cozy-client-js/intro/">Introduction</a>
</li>
            
<li >
    <a href="../../cozy-client-js/browser-sdk-transition/">Transition from cozy-browser-sdk</a>
</li>
            
<li >
    <a href="../../cozy-client-js/offline/">How to support offline</a>
</li>
            
<li >
    <a href="../../cozy-client-js/oauth/">OAuth guide</a>
</li>
            
<li >
    <a href="../../cozy-client-js/auth-api/">Authentication API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/data-api/">Data System API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/files-api/">Files API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/jobs-api/">Jobs API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/intents-api/">Intents API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/settings-api/">Settings API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/sharing-api/">Sharing API</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-konnector-libs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-konnector-libs/api/">API</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/cli/">CLI</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/dev/">Develop</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/errors/">Errors</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/operation-linking/">Operation linking</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/synchronization/">Synchronization</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-doctypes</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-doctypes/docs/README/">README</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.accounts/">Accounts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.photos.albums/">Albums</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bank/">Banking doctypes</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bills/">Bills</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.konnectors/">Connectors</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.contacts/">Contacts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.files/">Files</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.notifications/">Notifications</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.payslips/">Payslips</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.remote.requests/">Remote requests</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.sessions.logins/">Session logins</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.sharings/">Sharings</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.triggers/">Triggers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-stack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../README/">README</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Architecture</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../architecture/">General overview</a>
</li>
            
<li >
    <a href="../security/">Security</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Usage</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../INSTALL/">Install the cozy-stack</a>
</li>
            
<li >
    <a href="../cli/cozy-stack/">Manpages of the command-line tool</a>
</li>
            
<li >
    <a href="../config/">Configuration file</a>
</li>
            
<li >
    <a href="../instance/">Managing Instances</a>
</li>
            
<li >
    <a href="../onboarding/">Onboarding</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">For developpers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../client-app-dev/">Develop a client-side app</a>
</li>
            
<li >
    <a href="../docker/">Running and building Docker images</a>
</li>
            
<li >
    <a href="../release/">Build a release</a>
</li>
            
<li >
    <a href="../CONTRIBUTING/">The contributing guide</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Services</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../auth/">/auth - Authentication & OAuth</a>
</li>
            
<li >
    <a href="../apps/">/apps - Applications Management</a>
</li>
            
<li >
    <a href="../registry/">Apps registry</a>
</li>
            
<li >
    <a href="../data-system/">/data - Data System</a>
</li>
            
<li >
    <a href="../mango/">Mango</a>
</li>
            
<li >
    <a href="../replication/">Replication</a>
</li>
            
<li >
    <a href="../couchdb-quirks/">CouchDB Quirks</a>
</li>
            
<li >
    <a href="../pouchdb-quirks/">PouchDB Quirks</a>
</li>
            
<li >
    <a href="../files/">/files - Virtual File System</a>
</li>
            
<li >
    <a href="../references-docs-in-vfs/">References of documents in VFS</a>
</li>
            
<li >
    <a href="../intents/">/intents - Intents</a>
</li>
            
<li >
    <a href="../jobs/">/jobs Jobs</a>
</li>
            
<li >
    <a href="../konnectors/">Konnectors</a>
</li>
            
<li class="active">
    <a href="./">Workers</a>
</li>
            
<li >
    <a href="../move/">/move - Move, export and import an instance</a>
</li>
            
<li >
    <a href="../notifications/">/notifications - Notifications</a>
</li>
            
<li >
    <a href="../permissions/">/permissions - Permissions</a>
</li>
            
<li >
    <a href="../realtime/">/realtime - Realtime</a>
</li>
            
<li >
    <a href="../remote/">/remote - Proxy for remote data/API</a>
</li>
            
<li >
    <a href="../settings/">/settings - Settings</a>
</li>
            
<li >
    <a href="../sharing/">/sharings - Sharing</a>
</li>
            
<li >
    <a href="../sharing-design/">Request for comments</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">konitor</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../konitor/cli/">CLI</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-app-publish</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-app-publish/README/">CLI & Workflow</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-client</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-client/guide/">Usage guide</a>
</li>
            
<li >
    <a href="../../cozy-client/api/">API</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Synchronize <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../sync/linux/">Install Cozy Drive on GNU/Linux</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li>
                        <a href="https://github.com/cozy/cozy.github.io/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3">
<div class="bs-sidebar hidden-print affix" role="complementary">
    <ul class="nav bs-sidenav well" style='padding-left: 0; padding-right: 0; margin-bottom: 1.5rem'>
        <li class="main active"><a href="#workers">Workers</a></li>
            <li><a href="#log-worker">log worker</a></li>
            <li><a href="#push-worker">push worker</a></li>
            <li><a href="#unzip-worker">unzip worker</a></li>
            <li><a href="#sendmail-worker">sendmail worker</a></li>
            <li><a href="#export">export</a></li>
            <li><a href="#share-workers">share workers</a></li>
    </ul>
  <div style='padding-left: 2rem'>
    
    <a id='edit-link' href='https://github.com/cozy/cozy.github.io/edit/dev/src/cozy-stack/workers.md'>Edit documentation</a>
    <script type='text/javascript'>
        /* Here we detect if the current page is from an external documentation and we 
        change the href of the editing link so it goes to the right repository and file */
        const outsideDocs = [{"repo": "https://github.com/cozy/cozy-client-js.git", "name": "cozy-client-js", "subdir": "docs"}, {"repo": "https://github.com/konnectors/libs.git", "name": "cozy-konnector-libs", "subdir": "packages/cozy-konnector-libs/docs"}, {"repo": "https://github.com/cozy/cozy-doctypes.git", "name": "cozy-doctypes", "subdir": "."}, {"repo": "https://github.com/cozy/cozy-stack.git", "name": "cozy-stack", "subdir": "docs"}, {"repo": "https://github.com/konnectors/konitor.git", "name": "konitor", "subdir": "docs"}, {"repo": "https://github.com/cozy/cozy-app-publish.git", "name": "cozy-app-publish", "subdir": "."}, {"repo": "https://github.com/cozy/cozy-client.git", "name": "cozy-client", "subdir": "docs"}]
        const editNode = document.querySelector('#edit-link')
        const pathname = window.location.pathname
        const editURI = 'edit/master/'
        const removeGitSuffix = function (x) { return x.replace(/\.git$/, '') }

        // Returns the external repo associated to a pathname
        const detectExternalRepo = function (pathname) {
            for (var outsideDoc of outsideDocs) {
                if (window.location.pathname.includes('/' + outsideDoc.name + '/')) {
                    return outsideDoc
                }
            }
        }

        // Change the href attribute of a link to point to the correct edition page on GitHub
        // for the passed external documentation
        const fixEditLink = function (editNode, externalDoc) {
            const repoFile = pathname.replace('/en/' + externalDoc.name, '').replace(/\/$/, '.md')
            const baseRepo = removeGitSuffix(externalDoc.repo)
            editNode.href = baseRepo + '/' + editURI + externalDoc.subdir + repoFile
        }

        const externalRepo = detectExternalRepo(pathname)
        if (externalRepo) {
            fixEditLink(editNode, externalRepo)
        }
    </script>
    
  </div>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../README/#table-of-contents">Table of contents</a></p>
<h1 id="workers">Workers<a class="headerlink" href="#workers" title="Permanent link">&para;</a></h1>
<p>This page list all the currently available workers on the cozy-stack. It
describes their input arguments object. See the <a href="../jobs/">jobs document</a> to
know more about the API context in which you can see how to use these
arguments.</p>
<h2 id="log-worker">log worker<a class="headerlink" href="#log-worker" title="Permanent link">&para;</a></h2>
<p>The <code>log</code> worker will just print in the log file the job sent to it. It can
useful for debugging for example.</p>
<h2 id="push-worker">push worker<a class="headerlink" href="#push-worker" title="Permanent link">&para;</a></h2>
<p>The <code>push</code> worker can be used to send push-notifications to a user&rsquo;s device.
The options are:</p>
<ul>
<li><code>client_id</code>: the ID of the oauth client to push a notification to.</li>
<li><code>title</code>: the title of the notification</li>
<li><code>message</code>: the content of the notification</li>
<li><code>data</code>: key-value string map for additional metadata (optional)</li>
<li><code>priority</code>: the notification priority: <code>high</code> or <code>normal</code> (optional)</li>
<li><code>topic</code>: the topic identifier of the notification (optional)</li>
<li><code>sound</code>: a sound associated with the notification (optional)</li>
</ul>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;client_id&quot;: &quot;abcdef123123123&quot;,
  &quot;title&quot;: &quot;My Notification&quot;,
  &quot;message&quot;: &quot;My notification content.&quot;,
  &quot;priority&quot;: &quot;high&quot;
}</code></pre>


<h3 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h3>
<p>To use this worker from a client-side application, you will need to ask the
permission. It is done by adding this to the manifest:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;permissions&quot;: {
    &quot;push-notification&quot;: {
      &quot;description&quot;: &quot;Required to send notifications&quot;,
      &quot;type&quot;: &quot;io.cozy.jobs&quot;,
      &quot;verbs&quot;: [&quot;POST&quot;],
      &quot;selector&quot;: &quot;worker&quot;,
      &quot;values&quot;: [&quot;push&quot;]
    }
  }
}</code></pre>


<h2 id="unzip-worker">unzip worker<a class="headerlink" href="#unzip-worker" title="Permanent link">&para;</a></h2>
<p>The <code>unzip</code> worker can take a zip archive from the VFS, and will unzip the
files inside it to a directory of the VFS. The options are:</p>
<ul>
<li><code>zip</code>: the ID of the zip file</li>
<li><code>destination</code>: the ID of the directory where the files will be unzipped.</li>
</ul>
<h3 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;zip&quot;: &quot;8737b5d6-51b6-11e7-9194-bf5b64b3bc9e&quot;,
  &quot;destination&quot;: &quot;88750a84-51b6-11e7-ba90-4f0b1cb62b7b&quot;
}</code></pre>


<h3 id="permissions_1">Permissions<a class="headerlink" href="#permissions_1" title="Permanent link">&para;</a></h3>
<p>To use this worker from a client-side application, you will need to ask the
permission. It is done by adding this to the manifest:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;permissions&quot;: {
    &quot;unzip-to-a-directory&quot;: {
      &quot;description&quot;: &quot;Required to unzip a file inside the cozy&quot;,
      &quot;type&quot;: &quot;io.cozy.jobs&quot;,
      &quot;verbs&quot;: [&quot;POST&quot;],
      &quot;selector&quot;: &quot;worker&quot;,
      &quot;values&quot;: [&quot;unzip&quot;]
    }
  }
}</code></pre>


<h2 id="sendmail-worker">sendmail worker<a class="headerlink" href="#sendmail-worker" title="Permanent link">&para;</a></h2>
<p>The <code>sendmail</code> worker can be used to send mail from the stack. It implies that
the stack has properly configured an access to an SMTP server. You can see an
example of configuration in the <a href="../../cozy.example.yaml">cozy.example.yaml</a> file
at the root of this repository.</p>
<p><code>sendmail</code> options fields are the following:</p>
<ul>
<li><code>mode</code>: string specifying the mode of the send:</li>
<li><code>noreply</code> to send a notification mail to the user</li>
<li><code>from</code> to send a mail from the user</li>
<li><code>to</code>: list of object <code>{name, email}</code> representing the addresses of the
  recipients. (should not be used in <code>noreply</code> mode)</li>
<li><code>subject</code>: string specifying the subject of the mail</li>
<li><code>parts</code>: list of part objects <code>{type, body}</code> listing representing the content
  parts of the</li>
<li><code>type</code> string of the content type: either <code>text/html</code> or <code>text/plain</code></li>
<li><code>body</code> string of the actual body content of the part</li>
<li><code>attachments</code>: list of objects <code>{filename, content}</code> that represent the files
  attached to the email</li>
</ul>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-js">// from mode sending mail from the user to a list of recipients
{
    &quot;mode&quot;: &quot;from&quot;,
    &quot;to&quot;: [
        {&quot;name&quot;: &quot;John Doe 1&quot;, &quot;email&quot;:&quot;john1@doe&quot;},
        {&quot;name&quot;: &quot;John Doe 2&quot;, &quot;email&quot;:&quot;john2@doe&quot;}
    ],
    &quot;subject&quot;: &quot;Hey !&quot;,
    &quot;parts&quot;: [
        {&quot;type&quot;:&quot;text/html&quot;, &quot;body&quot;: &quot;&lt;h1&gt;Hey !&lt;/h1&gt;&quot;},
        {&quot;type&quot;:&quot;text/plain&quot;, &quot;body&quot;: &quot;Hey !&quot;}
    ]
}

// noreply mode, sending a notification mail to the user
{
    &quot;mode&quot;: &quot;noreply&quot;,
    &quot;subject&quot;: &quot;You've got a new file !&quot;,
    &quot;parts&quot;: [
        {&quot;type&quot;:&quot;text/html&quot;, &quot;body&quot;: &quot;&lt;h1&gt;Hey !&lt;/h1&gt;&quot;},
        {&quot;type&quot;:&quot;text/plain&quot;, &quot;body&quot;: &quot;Hey !&quot;}
    ]
}</code></pre>


<h3 id="permissions_2">Permissions<a class="headerlink" href="#permissions_2" title="Permanent link">&para;</a></h3>
<p>To use this worker from a client-side application, you will need to ask the
permission. It is done by adding this to the manifest:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;permissions&quot;: {
    &quot;mail-from-the-user&quot;: {
      &quot;description&quot;: &quot;Required to send mails from the user to his/her friends&quot;,
      &quot;type&quot;: &quot;io.cozy.jobs&quot;,
      &quot;verbs&quot;: [&quot;POST&quot;],
      &quot;selector&quot;: &quot;worker&quot;,
      &quot;values&quot;: [&quot;sendmail&quot;]
    }
  }
}</code></pre>


<h2 id="export">export<a class="headerlink" href="#export" title="Permanent link">&para;</a></h2>
<p>The <code>export</code> worker can be used to generate allow the export of all data
contained in the cozy. At the end of the export, a mail is sent to the user containing a link to access to its data.</p>
<p>The progress of the export process can be followed with realtime events on the doctype <code>io.cozy.exports</code>.</p>
<p>Its options are:</p>
<ul>
<li><code>parts_size</code>: the size in bytes of the sizes index splitting done for multi-part download of files data</li>
<li><code>max_age</code>: the maximum age duration of the archive before it expires</li>
<li><code>with_doctypes</code>: list of string for a whitelist of doctypes to exports (exports all doctypes if empty)</li>
<li><code>without_files</code>: boolean to avoid exporting the index (preventing download file data)</li>
</ul>
<h3 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;parts_size&quot;: 52428800,
  &quot;max_age&quot;: 60000000000, // 1 minute
  &quot;with_doctypes&quot;: [&quot;io.cozy.accounts&quot;], // empty or null means all doctypes
  &quot;without_files&quot;: false
}</code></pre>


<h3 id="permissions_3">Permissions<a class="headerlink" href="#permissions_3" title="Permanent link">&para;</a></h3>
<p>To use this worker from a client-side application, you will need to ask the
permission. It is done by adding this to the manifest:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;permissions&quot;: {
    &quot;mail-from-the-user&quot;: {
      &quot;description&quot;: &quot;Required to create a export of the user's data&quot;,
      &quot;type&quot;: &quot;io.cozy.jobs&quot;,
      &quot;verbs&quot;: [&quot;POST&quot;],
      &quot;selector&quot;: &quot;worker&quot;,
      &quot;values&quot;: [&quot;export&quot;]
    }
  }
}</code></pre>


<h2 id="share-workers">share workers<a class="headerlink" href="#share-workers" title="Permanent link">&para;</a></h2>
<p>The stack have 3 workers to power the sharings (internal usage only):</p>
<ol>
<li><code>share-track</code>, to update the <code>io.cozy.shared</code> database</li>
<li><code>share-replicate</code>, to start a replicator for most documents</li>
<li><code>share-upload</code>, to upload files</li>
</ol>
<h3 id="share-track">Share-track<a class="headerlink" href="#share-track" title="Permanent link">&para;</a></h3>
<p>The message is composed of 3 fields: the sharing ID, the rule index, and the
doctype. The event is similar to a realtime event: a verb, a document, and
optionaly the old version of this document.</p>
<h3 id="share-replicate-and-share-upload">Share-replicate and share-upload<a class="headerlink" href="#share-replicate-and-share-upload" title="Permanent link">&para;</a></h3>
<p>The message is composed of a sharing ID and a count of the number of errors
(i.e. the number of times this job was retried).</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <!-- Piwik -->
        <script type="text/javascript">
          var _paq = _paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//piwik.cozycloud.cc/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', '7']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
        <noscript><p><img src="//piwik.cozycloud.cc/piwik.php?idsite=7&rec=1" style="border:0;" alt="" /></p></noscript>
        <!-- End Piwik Code -->
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../extra.js"></script>
        <script src="../../search/main.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
